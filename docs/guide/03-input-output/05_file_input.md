# æ–‡ä»¶è¾“å…¥æ“ä½œ

## æ¦‚è¿°

æ–‡ä»¶è¾“å…¥æ˜¯Pythonç¼–ç¨‹ä¸­çš„é‡è¦æŠ€èƒ½ï¼Œæ¶‰åŠæ–‡ä»¶çš„æ‰“å¼€ã€è¯»å–ã€ç¼–ç å¤„ç†å’Œå¼‚å¸¸å¤„ç†ç­‰å¤šä¸ªæ–¹é¢ã€‚æœ¬èŠ‚å°†è¯¦ç»†ä»‹ç»å„ç§æ–‡ä»¶è¯»å–æ–¹æ³•å’Œæœ€ä½³å®è·µã€‚

## å­¦ä¹ ç›®æ ‡

- æŒæ¡æ–‡ä»¶çš„æ‰“å¼€å’Œå…³é—­æ“ä½œ
- å­¦ä¼šè¯»å–æ–‡ä»¶çš„ä¸åŒæ–¹æ³•
- äº†è§£æ–‡ä»¶ç¼–ç å’Œå¼‚å¸¸å¤„ç†
- æŒæ¡withè¯­å¥çš„ä½¿ç”¨
- å­¦ä¼šå¤„ç†ä¸åŒæ ¼å¼çš„æ–‡ä»¶
- æŒæ¡å¤§æ–‡ä»¶å¤„ç†æŠ€å·§

## å®Œæ•´ä»£ç 

```python
#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
æ–‡ä»¶è¾“å…¥æ“ä½œ

å­¦ä¹ ç›®æ ‡ï¼š
1. æŒæ¡æ–‡ä»¶çš„æ‰“å¼€å’Œå…³é—­æ“ä½œ
2. å­¦ä¼šè¯»å–æ–‡ä»¶çš„ä¸åŒæ–¹æ³•
3. äº†è§£æ–‡ä»¶ç¼–ç å’Œå¼‚å¸¸å¤„ç†
4. æŒæ¡withè¯­å¥çš„ä½¿ç”¨
5. å­¦ä¼šå¤„ç†ä¸åŒæ ¼å¼çš„æ–‡ä»¶

ä½œè€…ï¼šPythonåŸºç¡€æ•™ç¨‹
æ—¥æœŸï¼š2024å¹´
"""

import os
import json
import csv
from pathlib import Path

# ============================================================================
# 1. æ–‡ä»¶æ‰“å¼€å’Œå…³é—­åŸºç¡€
# ============================================================================

print("=" * 50)
print("1. æ–‡ä»¶æ‰“å¼€å’Œå…³é—­åŸºç¡€")
print("=" * 50)

# é¦–å…ˆåˆ›å»ºä¸€ä¸ªç¤ºä¾‹æ–‡ä»¶ç”¨äºæ¼”ç¤º
sample_text = """è¿™æ˜¯ç¬¬ä¸€è¡Œæ–‡æœ¬
è¿™æ˜¯ç¬¬äºŒè¡Œæ–‡æœ¬
è¿™æ˜¯ç¬¬ä¸‰è¡Œæ–‡æœ¬
åŒ…å«æ•°å­—ï¼š123
åŒ…å«ç‰¹æ®Šå­—ç¬¦ï¼š@#$%
"""

# åˆ›å»ºç¤ºä¾‹æ–‡ä»¶
with open('sample.txt', 'w', encoding='utf-8') as f:
    f.write(sample_text)

print("å·²åˆ›å»ºç¤ºä¾‹æ–‡ä»¶ sample.txt")

# åŸºæœ¬çš„æ–‡ä»¶æ‰“å¼€æ–¹å¼
print("\n--- åŸºæœ¬æ–‡ä»¶æ‰“å¼€æ–¹å¼ ---")

# æ–¹å¼1ï¼šä¼ ç»Ÿæ–¹å¼ï¼ˆéœ€è¦æ‰‹åŠ¨å…³é—­ï¼‰
print("\nä¼ ç»Ÿæ–¹å¼ï¼ˆä¸æ¨èï¼‰ï¼š")
file = open('sample.txt', 'r', encoding='utf-8')
content = file.read()
print(f"æ–‡ä»¶å†…å®¹ï¼š\n{content}")
file.close()  # å¿…é¡»æ‰‹åŠ¨å…³é—­æ–‡ä»¶
print("æ–‡ä»¶å·²å…³é—­")

# æ–¹å¼2ï¼šwithè¯­å¥ï¼ˆæ¨èæ–¹å¼ï¼‰
print("\nwithè¯­å¥ï¼ˆæ¨èï¼‰ï¼š")
with open('sample.txt', 'r', encoding='utf-8') as file:
    content = file.read()
    print(f"æ–‡ä»¶å†…å®¹ï¼š\n{content}")
# æ–‡ä»¶ä¼šè‡ªåŠ¨å…³é—­ï¼Œå³ä½¿å‘ç”Ÿå¼‚å¸¸ä¹Ÿä¼šå…³é—­
print("æ–‡ä»¶è‡ªåŠ¨å…³é—­")

# ============================================================================
# 2. æ–‡ä»¶è¯»å–çš„ä¸åŒæ–¹æ³•
# ============================================================================

print("\n" + "=" * 50)
print("2. æ–‡ä»¶è¯»å–çš„ä¸åŒæ–¹æ³•")
print("=" * 50)

# read() - è¯»å–æ•´ä¸ªæ–‡ä»¶
print("\n--- read() æ–¹æ³• ---")
with open('sample.txt', 'r', encoding='utf-8') as f:
    content = f.read()
    print(f"æ•´ä¸ªæ–‡ä»¶å†…å®¹ï¼š\n{repr(content)}")
    print(f"æ–‡ä»¶é•¿åº¦ï¼š{len(content)} ä¸ªå­—ç¬¦")

# read(size) - è¯»å–æŒ‡å®šå­—ç¬¦æ•°
print("\n--- read(size) æ–¹æ³• ---")
with open('sample.txt', 'r', encoding='utf-8') as f:
    first_10_chars = f.read(10)
    print(f"å‰10ä¸ªå­—ç¬¦ï¼š{repr(first_10_chars)}")
    next_10_chars = f.read(10)
    print(f"æ¥ä¸‹æ¥10ä¸ªå­—ç¬¦ï¼š{repr(next_10_chars)}")

# readline() - è¯»å–ä¸€è¡Œ
print("\n--- readline() æ–¹æ³• ---")
with open('sample.txt', 'r', encoding='utf-8') as f:
    line1 = f.readline()
    line2 = f.readline()
    line3 = f.readline()
    print(f"ç¬¬ä¸€è¡Œï¼š{repr(line1)}")
    print(f"ç¬¬äºŒè¡Œï¼š{repr(line2)}")
    print(f"ç¬¬ä¸‰è¡Œï¼š{repr(line3)}")

# readlines() - è¯»å–æ‰€æœ‰è¡Œåˆ°åˆ—è¡¨
print("\n--- readlines() æ–¹æ³• ---")
with open('sample.txt', 'r', encoding='utf-8') as f:
    lines = f.readlines()
    print(f"æ‰€æœ‰è¡Œï¼ˆåˆ—è¡¨ï¼‰ï¼š{lines}")
    print(f"æ€»å…± {len(lines)} è¡Œ")
    for i, line in enumerate(lines, 1):
        print(f"ç¬¬{i}è¡Œï¼š{line.strip()}")

# è¿­ä»£è¯»å–ï¼ˆæ¨èå¤§æ–‡ä»¶ï¼‰
print("\n--- è¿­ä»£è¯»å–ï¼ˆå†…å­˜å‹å¥½ï¼‰---")
with open('sample.txt', 'r', encoding='utf-8') as f:
    print("é€è¡Œè¿­ä»£ï¼š")
    for line_num, line in enumerate(f, 1):
        print(f"  è¡Œ{line_num}ï¼š{line.strip()}")

# ============================================================================
# 3. æ–‡ä»¶ç¼–ç å¤„ç†
# ============================================================================

print("\n" + "=" * 50)
print("3. æ–‡ä»¶ç¼–ç å¤„ç†")
print("=" * 50)

# åˆ›å»ºä¸åŒç¼–ç çš„æ–‡ä»¶
print("\n--- åˆ›å»ºä¸åŒç¼–ç çš„æ–‡ä»¶ ---")

# UTF-8ç¼–ç ï¼ˆæ¨èï¼‰
with open('utf8_file.txt', 'w', encoding='utf-8') as f:
    f.write("UTF-8ç¼–ç ï¼šä½ å¥½ä¸–ç•Œï¼Hello World!\n")
    f.write("ç‰¹æ®Šå­—ç¬¦ï¼šÂ©Â®â„¢â‚¬Â£Â¥\n")
    f.write("è¡¨æƒ…ç¬¦å·ï¼šğŸ˜€ğŸ˜ƒğŸ˜„ğŸ˜\n")

# GBKç¼–ç 
with open('gbk_file.txt', 'w', encoding='gbk') as f:
    f.write("GBKç¼–ç ï¼šä½ å¥½ä¸–ç•Œï¼\n")
    f.write("ä¸­æ–‡æµ‹è¯•æ–‡æœ¬\n")

print("å·²åˆ›å»ºä¸åŒç¼–ç çš„æ–‡ä»¶")

# è¯»å–ä¸åŒç¼–ç çš„æ–‡ä»¶
print("\n--- è¯»å–ä¸åŒç¼–ç çš„æ–‡ä»¶ ---")

# è¯»å–UTF-8æ–‡ä»¶
print("\nè¯»å–UTF-8æ–‡ä»¶ï¼š")
with open('utf8_file.txt', 'r', encoding='utf-8') as f:
    content = f.read()
    print(content)

# è¯»å–GBKæ–‡ä»¶
print("è¯»å–GBKæ–‡ä»¶ï¼š")
with open('gbk_file.txt', 'r', encoding='gbk') as f:
    content = f.read()
    print(content)

# ç¼–ç é”™è¯¯å¤„ç†
print("\n--- ç¼–ç é”™è¯¯å¤„ç† ---")

# é”™è¯¯å¤„ç†ç­–ç•¥
strategies = ['ignore', 'replace', 'strict']
for strategy in strategies:
    try:
        print(f"\nä½¿ç”¨ {strategy} ç­–ç•¥è¯»å–GBKæ–‡ä»¶ï¼ˆç”¨UTF-8ï¼‰ï¼š")
        with open('gbk_file.txt', 'r', encoding='utf-8', errors=strategy) as f:
            content = f.read()
            print(f"ç»“æœï¼š{repr(content)}")
    except UnicodeDecodeError as e:
        print(f"ç¼–ç é”™è¯¯ï¼š{e}")

# ============================================================================
# 4. å¼‚å¸¸å¤„ç†
# ============================================================================

print("\n" + "=" * 50)
print("4. æ–‡ä»¶æ“ä½œå¼‚å¸¸å¤„ç†")
print("=" * 50)

def safe_read_file(filename, encoding='utf-8'):
    """
    å®‰å…¨è¯»å–æ–‡ä»¶çš„å‡½æ•°
    """
    try:
        with open(filename, 'r', encoding=encoding) as f:
            return f.read()
    except FileNotFoundError:
        print(f"é”™è¯¯ï¼šæ–‡ä»¶ '{filename}' ä¸å­˜åœ¨")
        return None
    except PermissionError:
        print(f"é”™è¯¯ï¼šæ²¡æœ‰æƒé™è¯»å–æ–‡ä»¶ '{filename}'")
        return None
    except UnicodeDecodeError as e:
        print(f"é”™è¯¯ï¼šæ–‡ä»¶ç¼–ç é—®é¢˜ - {e}")
        return None
    except Exception as e:
        print(f"æœªçŸ¥é”™è¯¯ï¼š{e}")
        return None

print("\n--- å¼‚å¸¸å¤„ç†æ¼”ç¤º ---")

# æµ‹è¯•æ­£å¸¸æ–‡ä»¶
print("\nè¯»å–å­˜åœ¨çš„æ–‡ä»¶ï¼š")
content = safe_read_file('sample.txt')
if content:
    print(f"æˆåŠŸè¯»å–ï¼Œå†…å®¹é•¿åº¦ï¼š{len(content)} å­—ç¬¦")

# æµ‹è¯•ä¸å­˜åœ¨çš„æ–‡ä»¶
print("\nè¯»å–ä¸å­˜åœ¨çš„æ–‡ä»¶ï¼š")
content = safe_read_file('nonexistent.txt')

# æµ‹è¯•ç¼–ç é—®é¢˜
print("\nç”¨é”™è¯¯ç¼–ç è¯»å–æ–‡ä»¶ï¼š")
content = safe_read_file('gbk_file.txt', encoding='ascii')

# ============================================================================
# 5. æ–‡ä»¶ä¿¡æ¯è·å–
# ============================================================================

print("\n" + "=" * 50)
print("5. æ–‡ä»¶ä¿¡æ¯è·å–")
print("=" * 50)

def get_file_info(filename):
    """
    è·å–æ–‡ä»¶è¯¦ç»†ä¿¡æ¯
    """
    try:
        # ä½¿ç”¨os.path
        if os.path.exists(filename):
            stat = os.stat(filename)
            print(f"\næ–‡ä»¶ï¼š{filename}")
            print(f"å¤§å°ï¼š{stat.st_size} å­—èŠ‚")
            print(f"åˆ›å»ºæ—¶é—´ï¼š{stat.st_ctime}")
            print(f"ä¿®æ”¹æ—¶é—´ï¼š{stat.st_mtime}")
            print(f"æ˜¯å¦ä¸ºæ–‡ä»¶ï¼š{os.path.isfile(filename)}")
            print(f"æ˜¯å¦ä¸ºç›®å½•ï¼š{os.path.isdir(filename)}")
            
            # ä½¿ç”¨pathlibï¼ˆæ›´ç°ä»£çš„æ–¹å¼ï¼‰
            path = Path(filename)
            print(f"æ–‡ä»¶åï¼š{path.name}")
            print(f"æ‰©å±•åï¼š{path.suffix}")
            print(f"çˆ¶ç›®å½•ï¼š{path.parent}")
            print(f"ç»å¯¹è·¯å¾„ï¼š{path.absolute()}")
        else:
            print(f"æ–‡ä»¶ {filename} ä¸å­˜åœ¨")
    except Exception as e:
        print(f"è·å–æ–‡ä»¶ä¿¡æ¯æ—¶å‡ºé”™ï¼š{e}")

print("\n--- æ–‡ä»¶ä¿¡æ¯æ¼”ç¤º ---")
get_file_info('sample.txt')
get_file_info('utf8_file.txt')

# ============================================================================
# 6. è¯»å–ç‰¹æ®Šæ ¼å¼æ–‡ä»¶
# ============================================================================

print("\n" + "=" * 50)
print("6. è¯»å–ç‰¹æ®Šæ ¼å¼æ–‡ä»¶")
print("=" * 50)

# åˆ›å»ºJSONæ–‡ä»¶
print("\n--- JSONæ–‡ä»¶å¤„ç† ---")
data = {
    "name": "å¼ ä¸‰",
    "age": 25,
    "scores": [85, 92, 78],
    "info": {
        "city": "åŒ—äº¬",
        "email": "zhangsan@example.com"
    }
}

# å†™å…¥JSONæ–‡ä»¶
with open('data.json', 'w', encoding='utf-8') as f:
    json.dump(data, f, ensure_ascii=False, indent=2)

print("å·²åˆ›å»ºJSONæ–‡ä»¶")

# è¯»å–JSONæ–‡ä»¶
with open('data.json', 'r', encoding='utf-8') as f:
    loaded_data = json.load(f)
    print(f"JSONæ•°æ®ï¼š{loaded_data}")
    print(f"å§“åï¼š{loaded_data['name']}")
    print(f"å¹´é¾„ï¼š{loaded_data['age']}")
    print(f"åˆ†æ•°ï¼š{loaded_data['scores']}")

# åˆ›å»ºCSVæ–‡ä»¶
print("\n--- CSVæ–‡ä»¶å¤„ç† ---")
csv_data = [
    ['å§“å', 'å¹´é¾„', 'åŸå¸‚', 'åˆ†æ•°'],
    ['å¼ ä¸‰', '25', 'åŒ—äº¬', '85'],
    ['æå››', '22', 'ä¸Šæµ·', '92'],
    ['ç‹äº”', '28', 'å¹¿å·', '78']
]

# å†™å…¥CSVæ–‡ä»¶
with open('students.csv', 'w', newline='', encoding='utf-8') as f:
    writer = csv.writer(f)
    writer.writerows(csv_data)

print("å·²åˆ›å»ºCSVæ–‡ä»¶")

# è¯»å–CSVæ–‡ä»¶
print("\nè¯»å–CSVæ–‡ä»¶ï¼š")
with open('students.csv', 'r', encoding='utf-8') as f:
    reader = csv.reader(f)
    for row_num, row in enumerate(reader):
        if row_num == 0:
            print(f"è¡¨å¤´ï¼š{row}")
        else:
            print(f"æ•°æ®è¡Œ{row_num}ï¼š{row}")

# ä½¿ç”¨DictReaderè¯»å–CSV
print("\nä½¿ç”¨DictReaderè¯»å–CSVï¼š")
with open('students.csv', 'r', encoding='utf-8') as f:
    reader = csv.DictReader(f)
    for row in reader:
        print(f"å­¦ç”Ÿï¼š{row['å§“å']}ï¼Œå¹´é¾„ï¼š{row['å¹´é¾„']}ï¼ŒåŸå¸‚ï¼š{row['åŸå¸‚']}ï¼Œåˆ†æ•°ï¼š{row['åˆ†æ•°']}")

# ============================================================================
# 7. å¤§æ–‡ä»¶å¤„ç†æŠ€å·§
# ============================================================================

print("\n" + "=" * 50)
print("7. å¤§æ–‡ä»¶å¤„ç†æŠ€å·§")
print("=" * 50)

# åˆ›å»ºä¸€ä¸ªè¾ƒå¤§çš„ç¤ºä¾‹æ–‡ä»¶
print("\n--- åˆ›å»ºå¤§æ–‡ä»¶ç¤ºä¾‹ ---")
with open('large_file.txt', 'w', encoding='utf-8') as f:
    for i in range(1000):
        f.write(f"è¿™æ˜¯ç¬¬{i+1}è¡Œï¼ŒåŒ…å«ä¸€äº›æµ‹è¯•æ•°æ®ï¼š{i*2}, {i*3}, {i*5}\n")

print("å·²åˆ›å»ºå¤§æ–‡ä»¶ç¤ºä¾‹ï¼ˆ1000è¡Œï¼‰")

# é€è¡Œå¤„ç†å¤§æ–‡ä»¶ï¼ˆå†…å­˜å‹å¥½ï¼‰
print("\n--- é€è¡Œå¤„ç†å¤§æ–‡ä»¶ ---")
def process_large_file(filename):
    """
    å†…å­˜å‹å¥½çš„å¤§æ–‡ä»¶å¤„ç†
    """
    line_count = 0
    total_chars = 0
    
    with open(filename, 'r', encoding='utf-8') as f:
        for line in f:
            line_count += 1
            total_chars += len(line)
            
            # åªæ˜¾ç¤ºå‰5è¡Œå’Œå5è¡Œ
            if line_count <= 5 or line_count > 995:
                print(f"è¡Œ{line_count}ï¼š{line.strip()}")
            elif line_count == 6:
                print("... (çœç•¥ä¸­é—´è¡Œ) ...")
    
    return line_count, total_chars

lines, chars = process_large_file('large_file.txt')
print(f"\næ–‡ä»¶ç»Ÿè®¡ï¼š{lines}è¡Œï¼Œ{chars}ä¸ªå­—ç¬¦")

# åˆ†å—è¯»å–æ–‡ä»¶
print("\n--- åˆ†å—è¯»å–æ–‡ä»¶ ---")
def read_in_chunks(filename, chunk_size=1024):
    """
    åˆ†å—è¯»å–æ–‡ä»¶
    """
    chunk_count = 0
    with open(filename, 'r', encoding='utf-8') as f:
        while True:
            chunk = f.read(chunk_size)
            if not chunk:
                break
            chunk_count += 1
            print(f"å—{chunk_count}ï¼š{len(chunk)}ä¸ªå­—ç¬¦")
            if chunk_count >= 3:  # åªæ˜¾ç¤ºå‰3å—
                print("... (çœç•¥åç»­å—) ...")
                break
    return chunk_count

chunks = read_in_chunks('large_file.txt', 512)
print(f"æ€»å…±è¯»å–äº†{chunks}å—ï¼ˆå®é™…å¯èƒ½æ›´å¤šï¼‰")

# ============================================================================
# 8. å®é™…åº”ç”¨ç¤ºä¾‹
# ============================================================================

print("\n" + "=" * 50)
print("8. å®é™…åº”ç”¨ç¤ºä¾‹")
print("=" * 50)

def read_config_file(filename):
    """
    è¯»å–é…ç½®æ–‡ä»¶
    """
    config = {}
    try:
        with open(filename, 'r', encoding='utf-8') as f:
            for line_num, line in enumerate(f, 1):
                line = line.strip()
                if line and not line.startswith('#'):
                    if '=' in line:
                        key, value = line.split('=', 1)
                        config[key.strip()] = value.strip()
                    else:
                        print(f"è­¦å‘Šï¼šç¬¬{line_num}è¡Œæ ¼å¼ä¸æ­£ç¡®ï¼š{line}")
    except FileNotFoundError:
        print(f"é…ç½®æ–‡ä»¶ {filename} ä¸å­˜åœ¨")
    return config

def read_log_file(filename, level='INFO'):
    """
    è¯»å–æ—¥å¿—æ–‡ä»¶å¹¶è¿‡æ»¤çº§åˆ«
    """
    logs = []
    try:
        with open(filename, 'r', encoding='utf-8') as f:
            for line in f:
                if level in line:
                    logs.append(line.strip())
    except FileNotFoundError:
        print(f"æ—¥å¿—æ–‡ä»¶ {filename} ä¸å­˜åœ¨")
    return logs

def count_words_in_file(filename):
    """
    ç»Ÿè®¡æ–‡ä»¶ä¸­çš„å•è¯æ•°
    """
    word_count = {}
    try:
        with open(filename, 'r', encoding='utf-8') as f:
            for line in f:
                words = line.strip().split()
                for word in words:
                    # ç®€å•çš„å•è¯æ¸…ç†
                    word = word.lower().strip('.,!?;:')
                    if word:
                        word_count[word] = word_count.get(word, 0) + 1
    except FileNotFoundError:
        print(f"æ–‡ä»¶ {filename} ä¸å­˜åœ¨")
    return word_count

# åˆ›å»ºç¤ºä¾‹é…ç½®æ–‡ä»¶
config_content = """# åº”ç”¨é…ç½®æ–‡ä»¶
app_name=æˆ‘çš„åº”ç”¨
version=1.0.0
debug=true
port=8080
# æ•°æ®åº“é…ç½®
db_host=localhost
db_port=3306
"""

with open('config.txt', 'w', encoding='utf-8') as f:
    f.write(config_content)

# åˆ›å»ºç¤ºä¾‹æ—¥å¿—æ–‡ä»¶
log_content = """2024-01-01 10:00:00 INFO åº”ç”¨å¯åŠ¨
2024-01-01 10:01:00 DEBUG è¿æ¥æ•°æ®åº“
2024-01-01 10:02:00 INFO ç”¨æˆ·ç™»å½•ï¼šå¼ ä¸‰
2024-01-01 10:03:00 ERROR æ•°æ®åº“è¿æ¥å¤±è´¥
2024-01-01 10:04:00 INFO é‡æ–°è¿æ¥æ•°æ®åº“
2024-01-01 10:05:00 WARNING å†…å­˜ä½¿ç”¨ç‡è¿‡é«˜
"""

with open('app.log', 'w', encoding='utf-8') as f:
    f.write(log_content)

print("\n--- åº”ç”¨ç¤ºä¾‹æ¼”ç¤º ---")

# è¯»å–é…ç½®æ–‡ä»¶
print("\nè¯»å–é…ç½®æ–‡ä»¶ï¼š")
config = read_config_file('config.txt')
for key, value in config.items():
    print(f"{key}: {value}")

# è¯»å–æ—¥å¿—æ–‡ä»¶
print("\nè¯»å–INFOçº§åˆ«æ—¥å¿—ï¼š")
info_logs = read_log_file('app.log', 'INFO')
for log in info_logs:
    print(log)

# ç»Ÿè®¡å•è¯
print("\nç»Ÿè®¡sample.txtä¸­çš„å•è¯ï¼š")
words = count_words_in_file('sample.txt')
print("å•è¯ç»Ÿè®¡ï¼ˆå‰10ä¸ªï¼‰ï¼š")
for word, count in sorted(words.items(), key=lambda x: x[1], reverse=True)[:10]:
    print(f"{word}: {count}æ¬¡")

# ============================================================================
# 9. ç»ƒä¹ é¢˜
# ============================================================================

print("\n" + "=" * 50)
print("9. ç»ƒä¹ é¢˜")
print("=" * 50)

print("""
ç»ƒä¹ é¢˜ï¼š

1. åŸºç¡€ç»ƒä¹ ï¼š
   - ç¼–å†™å‡½æ•°è¯»å–æ–‡æœ¬æ–‡ä»¶å¹¶ç»Ÿè®¡è¡Œæ•°ã€å­—ç¬¦æ•°ã€å•è¯æ•°
   - åˆ›å»ºå‡½æ•°å®‰å…¨è¯»å–JSONæ–‡ä»¶ï¼Œå¤„ç†å„ç§å¼‚å¸¸
   - å®ç°ä¸€ä¸ªç®€å•çš„æ–‡ä»¶æœç´¢åŠŸèƒ½

2. è¿›é˜¶ç»ƒä¹ ï¼š
   - ç¼–å†™CSVæ–‡ä»¶åˆ†æå™¨ï¼Œè®¡ç®—æ•°å€¼åˆ—çš„ç»Ÿè®¡ä¿¡æ¯
   - å®ç°æ—¥å¿—æ–‡ä»¶åˆ†æå™¨ï¼Œæå–ç‰¹å®šæ—¶é—´æ®µçš„æ—¥å¿—
   - åˆ›å»ºé…ç½®æ–‡ä»¶è¯»å–å™¨ï¼Œæ”¯æŒå¤šç§æ ¼å¼

3. æ€è€ƒé¢˜ï¼š
   - ä»€ä¹ˆæ—¶å€™ä½¿ç”¨read()ï¼Œä»€ä¹ˆæ—¶å€™ä½¿ç”¨readline()ï¼Ÿ
   - å¦‚ä½•å¤„ç†è¶…å¤§æ–‡ä»¶ï¼ˆGBçº§åˆ«ï¼‰ï¼Ÿ
   - æ–‡ä»¶ç¼–ç é—®é¢˜å¦‚ä½•é¢„é˜²å’Œè§£å†³ï¼Ÿ

4. æŒ‘æˆ˜ç»ƒä¹ ï¼š
   - å®ç°ä¸€ä¸ªé€šç”¨çš„æ–‡ä»¶æ ¼å¼æ£€æµ‹å™¨
   - åˆ›å»ºæ”¯æŒå¤šç§ç¼–ç çš„æ–‡æœ¬æ–‡ä»¶è½¬æ¢å™¨
   - ç¼–å†™ä¸€ä¸ªæ–‡ä»¶å†…å®¹æ¯”è¾ƒå·¥å…·
""")

# ============================================================================
# 10. æ¸…ç†ä¸´æ—¶æ–‡ä»¶
# ============================================================================

print("\n" + "=" * 50)
print("10. æ¸…ç†ä¸´æ—¶æ–‡ä»¶")
print("=" * 50)

# æ¸…ç†æ¼”ç¤ºä¸­åˆ›å»ºçš„æ–‡ä»¶
temp_files = [
    'sample.txt', 'utf8_file.txt', 'gbk_file.txt', 
    'data.json', 'students.csv', 'large_file.txt',
    'config.txt', 'app.log'
]

print("\næ¸…ç†ä¸´æ—¶æ–‡ä»¶ï¼š")
for filename in temp_files:
    try:
        if os.path.exists(filename):
            os.remove(filename)
            print(f"å·²åˆ é™¤ï¼š{filename}")
    except Exception as e:
        print(f"åˆ é™¤ {filename} æ—¶å‡ºé”™ï¼š{e}")

# ============================================================================
# 11. çŸ¥è¯†ç‚¹æ€»ç»“
# ============================================================================

print("\n" + "=" * 50)
print("11. çŸ¥è¯†ç‚¹æ€»ç»“")
print("=" * 50)

print("""
çŸ¥è¯†ç‚¹æ€»ç»“ï¼š

1. æ–‡ä»¶æ‰“å¼€æ–¹å¼ï¼š
   - ä½¿ç”¨withè¯­å¥è‡ªåŠ¨ç®¡ç†æ–‡ä»¶å…³é—­
   - æŒ‡å®šæ­£ç¡®çš„ç¼–ç ï¼ˆé€šå¸¸æ˜¯utf-8ï¼‰
   - é€‰æ‹©åˆé€‚çš„æ‰“å¼€æ¨¡å¼ï¼ˆr, w, aç­‰ï¼‰

2. è¯»å–æ–¹æ³•é€‰æ‹©ï¼š
   - read()ï¼šè¯»å–æ•´ä¸ªæ–‡ä»¶ï¼ˆå°æ–‡ä»¶ï¼‰
   - readline()ï¼šé€è¡Œè¯»å–ï¼ˆéœ€è¦è¡Œå¤„ç†ï¼‰
   - è¿­ä»£ï¼šå†…å­˜å‹å¥½çš„é€è¡Œå¤„ç†ï¼ˆå¤§æ–‡ä»¶ï¼‰

3. å¼‚å¸¸å¤„ç†ï¼š
   - FileNotFoundErrorï¼šæ–‡ä»¶ä¸å­˜åœ¨
   - PermissionErrorï¼šæƒé™ä¸è¶³
   - UnicodeDecodeErrorï¼šç¼–ç é—®é¢˜

4. ç¼–ç å¤„ç†ï¼š
   - ä¼˜å…ˆä½¿ç”¨UTF-8ç¼–ç 
   - äº†è§£å¸¸è§ç¼–ç ï¼ˆGBKã€ASCIIç­‰ï¼‰
   - ä½¿ç”¨errorså‚æ•°å¤„ç†ç¼–ç é”™è¯¯

5. æ€§èƒ½ä¼˜åŒ–ï¼š
   - å¤§æ–‡ä»¶ä½¿ç”¨è¿­ä»£è¯»å–
   - åˆ†å—å¤„ç†è¶…å¤§æ–‡ä»¶
   - åŠæ—¶å…³é—­æ–‡ä»¶å¥æŸ„

6. æœ€ä½³å®è·µï¼š
   - å§‹ç»ˆä½¿ç”¨withè¯­å¥
   - å¤„ç†æ‰€æœ‰å¯èƒ½çš„å¼‚å¸¸
   - é€‰æ‹©åˆé€‚çš„è¯»å–æ–¹æ³•
   - æ³¨æ„æ–‡ä»¶ç¼–ç é—®é¢˜
""")

print("\nç¨‹åºè¿è¡Œå®Œæˆï¼")
print("å»ºè®®ï¼šå°è¯•è¯»å–ä¸åŒç±»å‹å’Œå¤§å°çš„æ–‡ä»¶ï¼Œä½“éªŒå„ç§è¯»å–æ–¹æ³•çš„å·®å¼‚ã€‚")
```

## ä»£ç è¯¦è§£

### 1. æ–‡ä»¶æ‰“å¼€å’Œå…³é—­

**ä¼ ç»Ÿæ–¹å¼ vs withè¯­å¥**ï¼š
- ä¼ ç»Ÿæ–¹å¼éœ€è¦æ‰‹åŠ¨è°ƒç”¨`close()`æ–¹æ³•
- withè¯­å¥è‡ªåŠ¨ç®¡ç†æ–‡ä»¶å…³é—­ï¼Œå³ä½¿å‘ç”Ÿå¼‚å¸¸ä¹Ÿä¼šæ­£ç¡®å…³é—­
- æ¨èå§‹ç»ˆä½¿ç”¨withè¯­å¥

### 2. æ–‡ä»¶è¯»å–æ–¹æ³•

**ä¸åŒè¯»å–æ–¹æ³•çš„ç‰¹ç‚¹**ï¼š
- `read()`ï¼šä¸€æ¬¡æ€§è¯»å–æ•´ä¸ªæ–‡ä»¶ï¼Œé€‚åˆå°æ–‡ä»¶
- `read(size)`ï¼šè¯»å–æŒ‡å®šå­—ç¬¦æ•°ï¼Œå¯æ§åˆ¶å†…å­˜ä½¿ç”¨
- `readline()`ï¼šé€è¡Œè¯»å–ï¼Œé€‚åˆéœ€è¦è¡Œå¤„ç†çš„åœºæ™¯
- `readlines()`ï¼šè¯»å–æ‰€æœ‰è¡Œåˆ°åˆ—è¡¨ï¼Œé€‚åˆä¸­ç­‰å¤§å°æ–‡ä»¶
- è¿­ä»£è¯»å–ï¼šæœ€å†…å­˜å‹å¥½ï¼Œé€‚åˆå¤§æ–‡ä»¶å¤„ç†

### 3. æ–‡ä»¶ç¼–ç å¤„ç†

**ç¼–ç ç›¸å…³è¦ç‚¹**ï¼š
- UTF-8æ˜¯æ¨èçš„é»˜è®¤ç¼–ç 
- ä¸åŒç¼–ç éœ€è¦æ­£ç¡®æŒ‡å®šencodingå‚æ•°
- ä½¿ç”¨errorså‚æ•°å¤„ç†ç¼–ç é”™è¯¯ï¼ˆignoreã€replaceã€strictï¼‰

### 4. å¼‚å¸¸å¤„ç†

**å¸¸è§å¼‚å¸¸ç±»å‹**ï¼š
- `FileNotFoundError`ï¼šæ–‡ä»¶ä¸å­˜åœ¨
- `PermissionError`ï¼šæƒé™ä¸è¶³
- `UnicodeDecodeError`ï¼šç¼–ç é—®é¢˜
- å»ºè®®åˆ›å»ºå®‰å…¨çš„æ–‡ä»¶è¯»å–å‡½æ•°

### 5. ç‰¹æ®Šæ ¼å¼æ–‡ä»¶

**JSONå’ŒCSVå¤„ç†**ï¼š
- JSONï¼šä½¿ç”¨jsonæ¨¡å—çš„load()å’Œdump()æ–¹æ³•
- CSVï¼šä½¿ç”¨csvæ¨¡å—çš„readerå’Œwriterç±»
- DictReaderå¯ä»¥å°†CSVè¡Œè½¬æ¢ä¸ºå­—å…¸

### 6. å¤§æ–‡ä»¶å¤„ç†

**æ€§èƒ½ä¼˜åŒ–æŠ€å·§**ï¼š
- ä½¿ç”¨è¿­ä»£è¯»å–é¿å…å†…å­˜æº¢å‡º
- åˆ†å—è¯»å–æ§åˆ¶å†…å­˜ä½¿ç”¨
- åªå¤„ç†éœ€è¦çš„æ•°æ®ï¼Œé¿å…å…¨éƒ¨åŠ è½½

## å­¦ä¹ è¦ç‚¹

### æ ¸å¿ƒæ¦‚å¿µ
1. **æ–‡ä»¶å¥æŸ„ç®¡ç†**ï¼šç†è§£æ–‡ä»¶æ‰“å¼€å’Œå…³é—­çš„é‡è¦æ€§
2. **ç¼–ç å¤„ç†**ï¼šæŒæ¡ä¸åŒç¼–ç çš„å¤„ç†æ–¹æ³•
3. **å¼‚å¸¸å¤„ç†**ï¼šå­¦ä¼šå¤„ç†å„ç§æ–‡ä»¶æ“ä½œå¼‚å¸¸
4. **æ€§èƒ½ä¼˜åŒ–**ï¼šäº†è§£ä¸åŒè¯»å–æ–¹æ³•çš„æ€§èƒ½ç‰¹ç‚¹

### æœ€ä½³å®è·µ
1. **å§‹ç»ˆä½¿ç”¨withè¯­å¥**ï¼šç¡®ä¿æ–‡ä»¶æ­£ç¡®å…³é—­
2. **æŒ‡å®šç¼–ç **ï¼šé¿å…ç¼–ç é—®é¢˜
3. **å¼‚å¸¸å¤„ç†**ï¼šå¤„ç†æ‰€æœ‰å¯èƒ½çš„å¼‚å¸¸æƒ…å†µ
4. **é€‰æ‹©åˆé€‚çš„è¯»å–æ–¹æ³•**ï¼šæ ¹æ®æ–‡ä»¶å¤§å°å’Œéœ€æ±‚é€‰æ‹©

### å¸¸è§é™·é˜±
1. **å¿˜è®°å…³é—­æ–‡ä»¶**ï¼šå¯èƒ½å¯¼è‡´èµ„æºæ³„éœ²
2. **ç¼–ç é—®é¢˜**ï¼šä¸åŒç¼–ç æ··ç”¨å¯¼è‡´ä¹±ç 
3. **å†…å­˜æº¢å‡º**ï¼šå¤§æ–‡ä»¶ä½¿ç”¨ä¸å½“çš„è¯»å–æ–¹æ³•
4. **å¼‚å¸¸æœªå¤„ç†**ï¼šç¨‹åºå´©æºƒæˆ–è¡Œä¸ºå¼‚å¸¸

## å®è·µç»ƒä¹ 

### åŸºç¡€ç»ƒä¹ 
1. åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ç»Ÿè®¡å‡½æ•°ï¼Œç»Ÿè®¡è¡Œæ•°ã€å­—ç¬¦æ•°ã€å•è¯æ•°
2. å®ç°å®‰å…¨çš„JSONæ–‡ä»¶è¯»å–å‡½æ•°
3. ç¼–å†™ç®€å•çš„æ–‡ä»¶æœç´¢åŠŸèƒ½

### è¿›é˜¶ç»ƒä¹ 
1. åˆ›å»ºCSVæ–‡ä»¶åˆ†æå™¨ï¼Œè®¡ç®—æ•°å€¼åˆ—ç»Ÿè®¡ä¿¡æ¯
2. å®ç°æ—¥å¿—æ–‡ä»¶åˆ†æå™¨ï¼Œæå–ç‰¹å®šæ—¶é—´æ®µæ—¥å¿—
3. ç¼–å†™æ”¯æŒå¤šç§æ ¼å¼çš„é…ç½®æ–‡ä»¶è¯»å–å™¨

### æŒ‘æˆ˜ç»ƒä¹ 
1. å®ç°é€šç”¨æ–‡ä»¶æ ¼å¼æ£€æµ‹å™¨
2. åˆ›å»ºå¤šç¼–ç æ–‡æœ¬æ–‡ä»¶è½¬æ¢å™¨
3. ç¼–å†™æ–‡ä»¶å†…å®¹æ¯”è¾ƒå·¥å…·

## è¿è¡Œç¤ºä¾‹

```bash
# è¿è¡Œå®Œæ•´ç¤ºä¾‹
python 05_file_input.py

# é¢„æœŸè¾“å‡ºåŒ…æ‹¬ï¼š
# - æ–‡ä»¶æ‰“å¼€å’Œå…³é—­æ¼”ç¤º
# - å„ç§è¯»å–æ–¹æ³•çš„ç»“æœ
# - ç¼–ç å¤„ç†ç¤ºä¾‹
# - å¼‚å¸¸å¤„ç†æ¼”ç¤º
# - æ–‡ä»¶ä¿¡æ¯è·å–
# - JSONå’ŒCSVå¤„ç†
# - å¤§æ–‡ä»¶å¤„ç†æŠ€å·§
# - å®é™…åº”ç”¨ç¤ºä¾‹
```

## æ‰©å±•æ€è€ƒ

1. **ä»€ä¹ˆæ—¶å€™ä½¿ç”¨ä¸åŒçš„è¯»å–æ–¹æ³•ï¼Ÿ**
   - å°æ–‡ä»¶ï¼ˆ<1MBï¼‰ï¼šå¯ä»¥ä½¿ç”¨read()
   - ä¸­ç­‰æ–‡ä»¶ï¼ˆ1MB-100MBï¼‰ï¼šä½¿ç”¨readline()æˆ–readlines()
   - å¤§æ–‡ä»¶ï¼ˆ>100MBï¼‰ï¼šå¿…é¡»ä½¿ç”¨è¿­ä»£è¯»å–

2. **å¦‚ä½•å¤„ç†è¶…å¤§æ–‡ä»¶ï¼Ÿ**
   - ä½¿ç”¨ç”Ÿæˆå™¨å’Œè¿­ä»£å™¨
   - åˆ†å—å¤„ç†
   - è€ƒè™‘ä½¿ç”¨ä¸“é—¨çš„å¤§æ•°æ®å¤„ç†å·¥å…·

3. **æ–‡ä»¶ç¼–ç é—®é¢˜å¦‚ä½•é¢„é˜²ï¼Ÿ**
   - ç»Ÿä¸€ä½¿ç”¨UTF-8ç¼–ç 
   - åœ¨æ–‡ä»¶å¤´éƒ¨å£°æ˜ç¼–ç 
   - ä½¿ç”¨ç¼–ç æ£€æµ‹å·¥å…·

## æ¨¡å—å¯¼èˆª

- [ä¸Šä¸€èŠ‚ï¼šæ ¼å¼åŒ–è¾“å‡º](./formatted-output.md)
- [ä¸‹ä¸€èŠ‚ï¼šæ–‡ä»¶è¾“å‡º](./file-output.md)
- [è¿”å›ç›®å½•](./index.md)